apiVersion: v1
kind: Pod
metadata:
  annotations:
    bind-mount-options:/etc/ecal: Z
    io.kubernetes.cri-o.TTY/ecal-allinone: "false"
    io.podman.annotations.autoremove/ecal-allinone: "TRUE"
    io.podman.annotations.cid-file/ecal-allinone: /run/ecal-allinone.cid
    io.podman.annotations.init/ecal-allinone: "TRUE"
    io.podman.annotations.privileged/ecal-allinone: "FALSE"
    io.podman.annotations.publish-all/ecal-allinone: "FALSE"
  labels:
    app: ecal-allinone
  name: ecal-allinone
spec:
  hostNetwork: true
  shareProcessNamespace: true
  containers:
  - image: localhost/ecal-cpp-subscriber:latest
    name: sub
    command:
      - /bin/bash
      - -c
      - '/opt/app/_build/hello_world_rec'
    securityContext:
      seLinuxOptions:
        type: 'spc_t'
    volumeMounts:
    - mountPath: /tmp
      name: tmpfs
    - mountPath: /etc/ecal
      name: ecal
    resources:
      limits:
        cpu: "1"
        memory: "512Mi"
      requests:
        cpu: "200m"
        memory: "256Mi"
  - image: localhost/ecal-cpp-publisher:latest
    name: pub
    command:
      - /bin/bash
      - -c
        # - 'sleep infinity'
      - '/opt/app/_build/hello_world_snd'
    securityContext:
      seLinuxOptions:
        type: 'spc_t'
    volumeMounts:
    - mountPath: /tmp
      name: tmpfs
    - mountPath: /etc/ecal
      name: ecal
    resources:
      limits:
        cpu: "1"
        memory: "512Mi"
      requests:
        cpu: "200m"
        memory: "256Mi"
  volumes:
  - hostPath:
      path: tmpfs
      type: DirectoryOrCreate
    name: tmpfs
  - hostPath:
      path: /etc/ecal
      type: Directory
    name: ecal
