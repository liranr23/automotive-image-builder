default:
  image: quay.io/centos-sig-automotive/automotive-osbuild

stages:
  - test

compose-test-job:
  stage: test
  script:
    - tests/test-compose tests/test-compose.json

compose-test-modified-targets:
  stage: test
  script:
    - tests/test-compose tests/test-compose.json $(git diff --name-only ${CI_MERGE_REQUEST_DIFF_BASE_SHA} | grep ^targets/ | xargs basename -s .ipp.yml)
  rules:
    - changes:
      - targets/*.ipp.yml
